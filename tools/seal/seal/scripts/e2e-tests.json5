{
  "meta": {
    "categories": [
      "packagers",
      "security",
      "misc",
      "flow",
      "hardening",
      "obfuscation",
      "ui",
      "deploy"
    ],
    "skipRisk": [
      "low",
      "medium",
      "high",
      "unknown"
    ],
    "requirements": [
      "host",
      "docker",
      "root",
      "toolset_full"
    ]
  },
  "tests": [
    {
      "name": "thin",
      "category": "packagers",
      "parallel": true,
      "description": "Builds and runs thin packager (core flow, runtime + integrity).",
      "skipRisk": "high",
      "failHint": "Check toolchain (cc/pkg-config/libzstd) and thin build logs.",
      "script": "tools/seal/seal/scripts/test-thin-e2e.js",
      "hostOnly": false,
      "requirements": []
    },
    {
      "name": "thin-anti-debug",
      "category": "security",
      "parallel": true,
      "description": "Validates anti-debug and hardening probes around thin runtime.",
      "skipRisk": "high",
      "failHint": "Check ptrace/perf/bpf tooling and strict env flags.",
      "script": "tools/seal/seal/scripts/test-thin-anti-debug-e2e.js",
      "hostOnly": false,
      "requirements": []
    },
    {
      "name": "thin-anti-debug-attach",
      "category": "security",
      "parallel": true,
      "description": "Runs thin anti-debug attach suite only.",
      "skipRisk": "high",
      "failHint": "Check ptrace/perf/bpf tooling and strict env flags.",
      "script": "tools/seal/seal/scripts/test-thin-anti-debug-attach-e2e.js",
      "hostOnly": false,
      "requirements": []
    },
    {
      "name": "thin-anti-debug-bootstrap",
      "category": "security",
      "parallel": true,
      "description": "Runs thin anti-debug bootstrap suite only.",
      "skipRisk": "high",
      "failHint": "Check ptrace/perf/bpf tooling and strict env flags.",
      "script": "tools/seal/seal/scripts/test-thin-anti-debug-bootstrap-e2e.js",
      "hostOnly": false,
      "requirements": []
    },
    {
      "name": "thin-anti-debug-build",
      "category": "security",
      "parallel": true,
      "description": "Runs thin anti-debug build suite only.",
      "skipRisk": "high",
      "failHint": "Check ptrace/perf/bpf tooling and strict env flags.",
      "script": "tools/seal/seal/scripts/test-thin-anti-debug-build-e2e.js",
      "hostOnly": false,
      "requirements": []
    },
    {
      "name": "thin-anti-debug-config",
      "category": "security",
      "parallel": true,
      "description": "Runs thin anti-debug config suite only.",
      "skipRisk": "high",
      "failHint": "Check ptrace/perf/bpf tooling and strict env flags.",
      "script": "tools/seal/seal/scripts/test-thin-anti-debug-config-e2e.js",
      "hostOnly": false,
      "requirements": []
    },
    {
      "name": "thin-anti-debug-env",
      "category": "security",
      "parallel": true,
      "description": "Runs thin anti-debug environment suite only.",
      "skipRisk": "high",
      "failHint": "Check ptrace/perf/bpf tooling and strict env flags.",
      "script": "tools/seal/seal/scripts/test-thin-anti-debug-env-e2e.js",
      "hostOnly": false,
      "requirements": []
    },
    {
      "name": "thin-anti-debug-leaks",
      "category": "security",
      "parallel": true,
      "description": "Runs thin anti-debug leaks suite only.",
      "skipRisk": "high",
      "failHint": "Check ptrace/perf/bpf tooling and strict env flags.",
      "script": "tools/seal/seal/scripts/test-thin-anti-debug-leaks-e2e.js",
      "hostOnly": false,
      "requirements": []
    },
    {
      "name": "thin-anti-debug-tamper",
      "category": "security",
      "parallel": true,
      "description": "Runs thin anti-debug tamper suite only.",
      "skipRisk": "high",
      "failHint": "Check ptrace/perf/bpf tooling and strict env flags.",
      "script": "tools/seal/seal/scripts/test-thin-anti-debug-tamper-e2e.js",
      "hostOnly": false,
      "requirements": []
    },
    {
      "name": "thin-anti-debug-dump",
      "category": "security",
      "parallel": true,
      "description": "Validates real runtime dump behavior (gcore/external dumps).",
      "skipRisk": "high",
      "failHint": "Check gcore/gdb or SEAL_E2E_DUMP_CMD and SEAL_E2E_REAL_DUMP.",
      "script": "tools/seal/seal/scripts/test-thin-anti-debug-dump-e2e.js",
      "hostOnly": false,
      "requirements": []
    },
    {
      "name": "legacy-packagers",
      "category": "packagers",
      "parallel": true,
      "description": "Covers legacy packagers (bundle/SEA) compatibility and runtime.",
      "skipRisk": "medium",
      "failHint": "Check postject/SEA tooling and packager availability.",
      "script": "tools/seal/seal/scripts/test-legacy-packagers-e2e.js",
      "hostOnly": false,
      "requirements": []
    },
    {
      "name": "full-packagers",
      "category": "packagers",
      "parallel": true,
      "description": "Builds bundle/SEA with protection enabled to validate packager compatibility.",
      "skipRisk": "medium",
      "failHint": "Check protection compatibility and packager tooling (postject/SEA).",
      "script": "tools/seal/seal/scripts/test-full-packagers-e2e.js",
      "hostOnly": false,
      "requirements": [
        "toolset_full"
      ]
    },
    {
      "name": "compat",
      "category": "misc",
      "parallel": true,
      "description": "Checks packager compatibility (sentinel/strip/elfPacker) via config explain.",
      "skipRisk": "low",
      "failHint": "Verify config explain output and packager gating.",
      "script": "tools/seal/seal/scripts/test-compat-e2e.js",
      "hostOnly": false,
      "requirements": []
    },
    {
      "name": "completion",
      "category": "misc",
      "parallel": true,
      "description": "Checks CLI bash completion output and target discovery.",
      "skipRisk": "low",
      "failHint": "Check bash availability and completion script output.",
      "script": "tools/seal/seal/scripts/test-completion-e2e.js",
      "hostOnly": false,
      "requirements": []
    },
    {
      "name": "workspace-defaults",
      "category": "misc",
      "parallel": true,
      "description": "Validates workspace defaults merging for subprojects.",
      "skipRisk": "low",
      "failHint": "Check workspace seal.json5 defaults merging logic.",
      "script": "tools/seal/seal/scripts/test-workspace-defaults-e2e.js",
      "hostOnly": false,
      "requirements": []
    },
    {
      "name": "workspace-batch",
      "category": "flow",
      "parallel": true,
      "description": "Ensures workspace auto-batch runs commands per project.",
      "skipRisk": "low",
      "failHint": "Check auto-batch detection and workspace project discovery.",
      "script": "tools/seal/seal/scripts/test-workspace-batch-e2e.js",
      "hostOnly": false,
      "requirements": []
    },
    {
      "name": "noop-a",
      "category": "misc",
      "parallel": true,
      "description": "No-op test used for orchestration and cleanup checks.",
      "skipRisk": "low",
      "failHint": "No-op test should always pass.",
      "script": "tools/seal/seal/scripts/test-noop-a-e2e.js",
      "hostOnly": false,
      "requirements": []
    },
    {
      "name": "noop-b",
      "category": "misc",
      "parallel": true,
      "description": "No-op test used for orchestration and cleanup checks.",
      "skipRisk": "low",
      "failHint": "No-op test should always pass.",
      "script": "tools/seal/seal/scripts/test-noop-b-e2e.js",
      "hostOnly": false,
      "requirements": []
    },
    {
      "name": "cleanup-guard",
      "category": "flow",
      "parallel": false,
      "description": "Runs a small parallel suite and verifies no run directories are left behind.",
      "skipRisk": "medium",
      "failHint": "Check E2E cleanup handlers and worker temp roots.",
      "script": "tools/seal/seal/scripts/test-e2e-cleanup-e2e.js",
      "hostOnly": false,
      "requirements": []
    },
    {
      "name": "clean",
      "category": "flow",
      "parallel": true,
      "description": "Validates seal clean scopes for seal-out cleanup.",
      "skipRisk": "low",
      "failHint": "Check seal clean behavior and seal-out paths.",
      "script": "tools/seal/seal/scripts/test-clean-e2e.js",
      "hostOnly": false,
      "requirements": []
    },
    {
      "name": "profile-overlay",
      "category": "misc",
      "parallel": true,
      "description": "Validates profile overlay in config explain and build metadata.",
      "skipRisk": "low",
      "failHint": "Check build.profileOverlays in seal.json5 and config explain output.",
      "script": "tools/seal/seal/scripts/test-profile-overlay-e2e.js",
      "hostOnly": false,
      "requirements": []
    },
    {
      "name": "install",
      "category": "misc",
      "parallel": false,
      "description": "Runs install.sh in a clean HOME and verifies seal + bash completion.",
      "skipRisk": "medium",
      "failHint": "Check install.sh logs, apt availability, and completion output.",
      "script": "tools/seal/seal/scripts/test-install-e2e.js",
      "hostOnly": false,
      "requirements": [
        "docker",
        "root"
      ]
    },
    {
      "name": "user-flow",
      "category": "flow",
      "parallel": false,
      "description": "Exercises end-to-end user flow (init/build/run/deploy style).",
      "skipRisk": "high",
      "failHint": "Check SSH/systemd readiness and example workspace.",
      "script": "tools/seal/seal/scripts/test-user-flow-e2e.js",
      "hostOnly": false,
      "requirements": []
    },
    {
      "name": "sentinel",
      "category": "security",
      "parallel": true,
      "description": "Verifies sentinel install/verify paths and hardware IDs.",
      "skipRisk": "high",
      "failHint": "Check root access, /etc/machine-id, and host device IDs.",
      "script": "tools/seal/seal/scripts/test-sentinel-e2e.js",
      "hostOnly": false,
      "requirements": [
        "root"
      ]
    },
    {
      "name": "protection",
      "category": "hardening",
      "parallel": true,
      "description": "Validates protection features (guards, modes, checks).",
      "skipRisk": "high",
      "failHint": "Check kernel/ptrace settings and protection config.",
      "script": "tools/seal/seal/scripts/test-protection-e2e.js",
      "hostOnly": false,
      "requirements": []
    },
    {
      "name": "full-protection",
      "category": "hardening",
      "parallel": false,
      "description": "Runs full protection stack (thin-split + sentinel + obfuscation + packers).",
      "skipRisk": "high",
      "failHint": "Check root, toolset full, and kiteshield/strip/ollvm-clang availability.",
      "script": "tools/seal/seal/scripts/test-full-protection-e2e.js",
      "hostOnly": false,
      "requirements": [
        "root",
        "toolset_full"
      ]
    },
    {
      "name": "obfuscation",
      "category": "obfuscation",
      "parallel": true,
      "description": "Tests JS/C obfuscation pipeline and runtime behavior.",
      "skipRisk": "medium",
      "failHint": "Check obfuscator tools and build logs.",
      "script": "tools/seal/seal/scripts/test-obfuscation-e2e.js",
      "hostOnly": false,
      "requirements": []
    },
    {
      "name": "strip",
      "category": "hardening",
      "parallel": true,
      "description": "Verifies strip/ELF cleanup rules and runtime smoke.",
      "skipRisk": "medium",
      "failHint": "Check strip tool and ELF expectations.",
      "script": "tools/seal/seal/scripts/test-strip-e2e.js",
      "hostOnly": false,
      "requirements": []
    },
    {
      "name": "elf-packers",
      "category": "hardening",
      "parallel": true,
      "description": "Validates ELF packers (upx/kiteshield/midgetpack) and runtime.",
      "skipRisk": "medium",
      "failHint": "Check packer availability and settings.",
      "script": "tools/seal/seal/scripts/test-elf-packers-e2e.js",
      "hostOnly": false,
      "requirements": []
    },
    {
      "name": "c-obfuscators",
      "category": "obfuscation",
      "parallel": true,
      "description": "Tests C obfuscator variants and runtime checks.",
      "skipRisk": "medium",
      "failHint": "Check C++ toolchain and obfuscator binaries.",
      "script": "tools/seal/seal/scripts/test-c-obfuscators-e2e.js",
      "hostOnly": false,
      "requirements": []
    },
    {
      "name": "postject",
      "category": "misc",
      "parallel": true,
      "description": "Ensures postject/SEA injection workflow is functional.",
      "skipRisk": "medium",
      "failHint": "Check postject availability and SEA metadata.",
      "script": "tools/seal/seal/scripts/test-postject-e2e.js",
      "hostOnly": false,
      "requirements": []
    },
    {
      "name": "example-ui",
      "category": "ui",
      "parallel": false,
      "description": "Verifies example UI flow (build/run/playwright).",
      "skipRisk": "medium",
      "failHint": "Check Playwright browsers and port availability.",
      "script": "tools/seal/seal/scripts/test-example-ui-e2e.js",
      "hostOnly": false,
      "requirements": []
    },
    {
      "name": "decoy",
      "category": "obfuscation",
      "parallel": true,
      "description": "Validates decoy file installation and collision handling.",
      "skipRisk": "low",
      "failHint": "Check decoy config and output integrity.",
      "script": "tools/seal/seal/scripts/test-decoy-e2e.js",
      "hostOnly": false,
      "requirements": []
    },
    {
      "name": "config-sync",
      "category": "deploy",
      "parallel": false,
      "description": "Exercises config add/diff/push/pull with SSH sync.",
      "skipRisk": "high",
      "failHint": "Check SSH env (SEAL_SHIP_SSH_*), sudo, and remote shared/config.json5.",
      "script": "tools/seal/seal/scripts/test-config-sync-e2e.js",
      "hostOnly": false,
      "requirements": []
    },
    {
      "name": "ship",
      "category": "deploy",
      "parallel": false,
      "description": "Covers ship/deploy flow (bootstrap and SSH).",
      "skipRisk": "high",
      "failHint": "Check SSH, sudo, and target config.",
      "script": "tools/seal/seal/scripts/test-ship-e2e.js",
      "hostOnly": false,
      "requirements": []
    },
    {
      "name": "diag",
      "category": "misc",
      "parallel": true,
      "description": "Diagnostic bundle creation (seal diag).",
      "skipRisk": "low",
      "failHint": "Check seal-out permissions and local CLI path.",
      "script": "tools/seal/seal/scripts/test-diag-e2e.js",
      "hostOnly": false,
      "requirements": []
    }
  ]
}
