#!/usr/bin/env bash
# SEAL E2E defaults (auto-loaded by E2E scripts).
# Copy to .seal/e2e.env to override per-repo without touching this file.

# Docker E2E
SEAL_DOCKER_E2E_REMOTE="${SEAL_DOCKER_E2E_REMOTE:-1}"
SEAL_DOCKER_E2E_REMOTE_FALLBACK="${SEAL_DOCKER_E2E_REMOTE_FALLBACK:-1}"
SEAL_DOCKER_E2E_PULL="${SEAL_DOCKER_E2E_PULL:-0}"
SEAL_DOCKER_E2E_BUILDER="${SEAL_DOCKER_E2E_BUILDER:-full}"
SEAL_DOCKER_E2E_REBUILD="${SEAL_DOCKER_E2E_REBUILD:-0}"
SEAL_DOCKER_E2E_CACHE_DIR="${SEAL_DOCKER_E2E_CACHE_DIR:-/var/tmp/seal-e2e-cache}"
SEAL_DOCKER_E2E_PROGRESS="${SEAL_DOCKER_E2E_PROGRESS:-plain}"
SEAL_DOCKER_E2E_SAVE_IMAGE="${SEAL_DOCKER_E2E_SAVE_IMAGE:-1}"
SEAL_DOCKER_E2E_BUILD_NETWORK="${SEAL_DOCKER_E2E_BUILD_NETWORK:-host}"
SEAL_DOCKER_E2E_BUILD_NETWORK_FALLBACK="${SEAL_DOCKER_E2E_BUILD_NETWORK_FALLBACK:-default}"
SEAL_DOCKER_E2E_CGROUPNS="${SEAL_DOCKER_E2E_CGROUPNS:-host}"
SEAL_DOCKER_E2E_SHM_SIZE="${SEAL_DOCKER_E2E_SHM_SIZE:-2g}"
SEAL_DOCKER_E2E_IPC="${SEAL_DOCKER_E2E_IPC:-}"
SEAL_DOCKER_E2E_SSHD_TIMEOUT="${SEAL_DOCKER_E2E_SSHD_TIMEOUT:-60}"
SEAL_E2E_TOOLSET="${SEAL_E2E_TOOLSET:-core}"

# Share example node_modules across runs to avoid re-install.
SEAL_E2E_USE_SHARED_NODE_MODULES="${SEAL_E2E_USE_SHARED_NODE_MODULES:-1}"

# Parallelism
SEAL_E2E_PARALLEL="${SEAL_E2E_PARALLEL:-1}"
SEAL_E2E_PARALLEL_MODE="${SEAL_E2E_PARALLEL_MODE:-per-test}"
SEAL_E2E_JOBS="${SEAL_E2E_JOBS:-}"

# Dependency installs (leave empty for auto-detect)
SEAL_E2E_INSTALL_DEPS="${SEAL_E2E_INSTALL_DEPS:-}"
SEAL_E2E_INSTALL_PACKERS="${SEAL_E2E_INSTALL_PACKERS:-}"
SEAL_E2E_INSTALL_OBFUSCATORS="${SEAL_E2E_INSTALL_OBFUSCATORS:-}"
SEAL_E2E_INSTALL_EXAMPLE_DEPS="${SEAL_E2E_INSTALL_EXAMPLE_DEPS:-}"

# Force rebuilds (set to 1 to recompile)
SEAL_E2E_REINSTALL_PACKERS="${SEAL_E2E_REINSTALL_PACKERS:-0}"
SEAL_E2E_REINSTALL_OBFUSCATORS="${SEAL_E2E_REINSTALL_OBFUSCATORS:-0}"

# Optional test filters
SEAL_E2E_TESTS="${SEAL_E2E_TESTS:-}"
SEAL_E2E_SKIP="${SEAL_E2E_SKIP:-}"
# Set to 1 to skip host-only tests that need full kernel/systemd access.
# Leave empty to let runners pick defaults (docker defaults to 1).
SEAL_E2E_LIMITED_HOST="${SEAL_E2E_LIMITED_HOST:-}"

# Runtime readiness (set to 1 to avoid HTTP listen and use ready-file mode)
SEAL_E2E_NO_LISTEN="${SEAL_E2E_NO_LISTEN:-0}"

# Isolation (docker defaults to isolate HOME unless overridden)
SEAL_E2E_ISOLATE_HOME="${SEAL_E2E_ISOLATE_HOME:-}"
SEAL_E2E_HOME_ROOT="${SEAL_E2E_HOME_ROOT:-}"
SEAL_E2E_HOME_KEEP="${SEAL_E2E_HOME_KEEP:-0}"
SEAL_E2E_SAFE_ROOTS="${SEAL_E2E_SAFE_ROOTS:-}"
SEAL_E2E_UNSAFE_EXAMPLE_ROOT="${SEAL_E2E_UNSAFE_EXAMPLE_ROOT:-0}"
SEAL_E2E_RUN_ID="${SEAL_E2E_RUN_ID:-}"

# Reporting
SEAL_E2E_SUMMARY_PATH="${SEAL_E2E_SUMMARY_PATH:-}"
SEAL_E2E_SUMMARY_APPEND="${SEAL_E2E_SUMMARY_APPEND:-0}"
SEAL_E2E_SUMMARY_SCOPE="${SEAL_E2E_SUMMARY_SCOPE:-all}"
SEAL_E2E_LOG_DIR="${SEAL_E2E_LOG_DIR:-}"
SEAL_E2E_LOG_TAIL_LINES="${SEAL_E2E_LOG_TAIL_LINES:-40}"
SEAL_E2E_CAPTURE_LOGS="${SEAL_E2E_CAPTURE_LOGS:-1}"
# Set to 0 to suppress "filtered" skip logs.
SEAL_E2E_LOG_FILTERED="${SEAL_E2E_LOG_FILTERED:-}"
SEAL_UI_E2E_TRACE="${SEAL_UI_E2E_TRACE:-}"
SEAL_UI_E2E_ARTIFACTS="${SEAL_UI_E2E_ARTIFACTS:-}"

# Rerun failed tests
SEAL_E2E_RERUN_FAILED="${SEAL_E2E_RERUN_FAILED:-0}"
SEAL_E2E_RERUN_FROM="${SEAL_E2E_RERUN_FROM:-}"
SEAL_E2E_FAIL_FAST="${SEAL_E2E_FAIL_FAST:-0}"

# Strict anti-debug flags (set to 1 to enforce)
SEAL_E2E_STRICT_PROC_MEM="${SEAL_E2E_STRICT_PROC_MEM:-0}"
SEAL_E2E_STRICT_PTRACE="${SEAL_E2E_STRICT_PTRACE:-0}"
SEAL_E2E_STRICT_SNAPSHOT_GUARD="${SEAL_E2E_STRICT_SNAPSHOT_GUARD:-0}"
SEAL_E2E_STRICT_SYSLOG="${SEAL_E2E_STRICT_SYSLOG:-0}"
